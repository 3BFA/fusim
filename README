===============================================================================
Fusim - FUSion SIMulator
===============================================================================

Fusim is a program to simulate fusion genes from a reference genome. 

---------------------
Requirements
---------------------

- Java
- UCSC RefFlat (GenePred table format)
    See: http://genome.ucsc.edu/FAQ/FAQformat.html#format9
- Reference genome in fasta 
- samtools (for indexing only)

---------------------
Setup
---------------------

1. Download UCSC RefFlat GenePred data

  $ wget -O refFlat.txt.gz http://hgdownload.cse.ucsc.edu/goldenPath/hg19/database/refFlat.txt
  $ gunzip refFlat.txt.gz


2. Download genome reference from UCSC:

  $ wget ftp://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz

3. Extract and build one single fasta file:

  $ tar -xzf chromFa.tar.gz
  $ cat chr*.fa > hg19.fa

4. Index with samtools:

  $ samtools faidx hg19.fa


---------------------
Basic Usage
---------------------

$ java -jar fusim.jar -h
usage: fusim
-b,--bam <arg>           Background BAM file
-c,--cds                 Only include CDS exons
-f,--fasta <arg>         File name of fasta output
-g,--genemodel <arg>     Gene Model file
-h,--help                print usage info
-i,--gtf <arg>           Input GTF file for conversion
-k,--cutoff <arg>        RPKM cutoff when using background BAM file
-n,--fusions <arg>       Total number of fusions to generate
-o,--output <arg>        Output refFlat file for conversion
-p,--threads <arg>       Number of threads to spawn when processing
                         background BAM file
-r,--reference <arg>     Reference genome indexed fasta, fai
-t,--text <arg>          File name of text output
-x,--readthrough <arg>   Number of read through fusion genes
-z,--convert             Convert GTF/GFF to refFlat (genePred) format


- Generate Fusion genes using UCSC refFlat.txt gene model:

  $ java -jar fusim.jar -g refFlat.txt -n 10

- Output to both FASTA and TXT format:

  $ java -jar fusim.jar \
         --genemodel=refFlat.txt \
         --fusions=10 \
         --reference=hg10.fa \
         --fasta=fusions.fasta \
         --text=fusions.txt

- Generate Fusion genes based on a background dataset (BAM file) using RPKM
  cutoff of 0.2. Note background BAM files must be indexed (*.bam.bai):

  $ java -jar fusim.jar -g refFlat.txt -n 10 -b background-reads.bam --cutoff=0.2

- Generate Fusion genes with read through genes:

  $ java -jar fusim.jar -g refFlat.txt -n 10 -x 5

- Only use CDS exons when generating fusion genes:

  $ java -jar fusim.jar -g refFlat.txt -n 10 --cds

- Working with GFF/GTF format
    
    - First need to convert GFF/GTF to refFlat (genePred) format:
      $ java -jar fusim.jar --convert -i gencode.gtf -o gencodeRefFlat.txt

    - Then run fusim using the converted refFlat file:
      $ java -jar fusim.jar -g gencodeRefFlat.txt -n 10

---------------------
Authors
---------------------

- Andrew E. Bruno
- Song Lui
- Jianmin Wang
- Jeffrey C. Miecznikowski
